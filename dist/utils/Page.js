"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _asyncToGenerator(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,r){function n(i,s){try{var a=e[i](s),o=a.value}catch(t){return void r(t)}if(!a.done)return Promise.resolve(o).then(function(t){n("next",t)},function(t){n("throw",t)});t(o)}return n("next")})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),_Http=require("./Http.js"),_Http2=_interopRequireDefault(_Http),Pagination=function(){function t(e,r){_classCallCheck(this,t),this.url=e,this.list=[],this.start=1,this.count=1,this.processFunc=r,this.loading=!1,this.params=[],this.reachBottom=!1,this.empty=!0,this.toClear=!1}return _createClass(t,[{key:"next",value:function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function t(e){var r,n,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r={page:this.start},!this.loading){t.next=4;break}return console.warn("page loading!"),t.abrupt("return",this);case 4:return this.loading=!0,t.prev=5,Object.assign(r,e),t.next=9,_Http2.default.get(this.url,r);case 9:if(n=t.sent,!(null===(i=n.data)||i.length<1)){t.next=14;break}return this.toClear?this.clear():this.reachBottom=!0,t.abrupt("return",this);case 14:return this.empty=!1,this._processData(i),this.toClear?(this.list=i,this.toClear=!1):this.list=this.list.concat(i),this.start+=this.count,i.length<this.count&&(this.reachBottom=!0),t.abrupt("return",this);case 20:return t.prev=20,this.loading=!1,t.finish(20);case 23:case"end":return t.stop()}},t,this,[[5,,20,23]])}));return t}()},{key:"reset",value:function(){this.empty=!0,this.toClear=!0,this.start=1,this.reachBottom=!1}},{key:"clear",value:function(){this.toClear=!1,this.start=1,this.list=[]}},{key:"_processData",value:function(t){if(this.processFunc)for(var e in t){var r=this.processFunc(t[e]);r&&(t[e]=r)}}}]),t}();exports.default=Pagination;