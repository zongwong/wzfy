"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(a,u){try{var o=t[a](u),i=o.value}catch(e){return void r(e)}if(!o.done)return Promise.resolve(i).then(function(e){n("next",e)},function(e){n("throw",e)});e(i)}return n("next")})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_wepy=require("./../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),_Tips=require("./Tips.js"),_Tips2=_interopRequireDefault(_Tips),http=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"request",value:function(){function e(e,r,n){return t.apply(this,arguments)}var t=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r,n){var a,u,o,i=(!(arguments.length>3&&void 0!==arguments[3])||arguments[3],!(arguments.length>4&&void 0!==arguments[4])||arguments[4]);return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={url:r,method:t,data:n},i&&(u=_wepy2.default.getStorageSync("token"),a.header={"content-type":"application/x-www-form-urlencoded",Authorization:"Bearer "+u}),e.next=5,_wepy2.default.request(a);case 5:if(o=e.sent,200!=o.statusCode){e.next=14;break}if(0!=o.data.code||"你还未登录"!=o.data.message||o.data.status){e.next=11;break}_wepy2.default.navigateTo({url:"/pages/index/bind"}),e.next=12;break;case 11:return e.abrupt("return",o.data);case 12:e.next=15;break;case 14:throw this.requestException(o);case 15:case"end":return e.stop()}},e,this)}));return e}()},{key:"isSuccess",value:function(e){if(200!==e.statusCode)return!1;var t=e.data;return!(t&&0!==t.code)}},{key:"requestException",value:function(e){var t={};t.statusCode=e.statusCode;var r=e.data,n=r.data;return n&&(t.serverCode=r.code,t.message=n.message,t.serverData=n),t}},{key:"get",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.request("GET",e,t,r)}},{key:"put",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.request("PUT",e,t,r)}},{key:"post",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.request("POST",e,t,r)}},{key:"patch",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.request("PATCH",e,t,r)}},{key:"delete",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.request("DELETE",e,t,r)}}]),e}();exports.default=http;